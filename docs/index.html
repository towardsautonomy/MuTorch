<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MuTorch: A lightweight Deep Learning framework with PyTorch-like API: MuTorch: A lightweight Deep Learning framework with PyTorch-like API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="towards-autonomy.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MuTorch: A lightweight Deep Learning framework with PyTorch-like API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">MuTorch: A lightweight Deep Learning framework with PyTorch-like API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://github.com/towardsautonomy/mutorch"><b>GitHub</b></a></p>
<p>MuTorch is a deep learning framework built for educational purposes and to build a deep understanding of how neural networks work. This is not intended to be efficient, but rather very simplistic. The goal is to create a framework that is easy to understand, modify, and learn from. <b>It does not use external libraries and is built from scratch using only Python lists and operators</b>.</p>
<p>Some of the nomenclature used in this framework is inspired by PyTorch and are defined below:</p>
<ul>
<li><b>Node</b>: A node is the most basic unit of the computational graph and represents either a value or an operation. <br  />
</li>
<li><b>Neuron</b>: A neuron is a collection of node which represents a single unit of the neural network. It uses a stack of <em>nodes</em> to compute <b>Wx + b</b> and then applies an activation function to the result. <br  />
</li>
<li><b>Tensor</b>: A tensor is a collection of <em>nodes</em> and can be multi-dimensional. It is used to represent the input and output of a neuron. <br  />
</li>
<li><b>Layer</b>: A layer performs computations on a tensor and returns a tensor. <br  />
</li>
</ul>
<p>The framework is built in a modular way, and can be extended to include new layers, activation functions, and optimizers. Examples of how to use the framework to build <em>node-level</em>, <em>tensor-level</em>, or a full fledged <em>Sequential MLP</em> are provided in the <a href="https://github.com/towardsautonomy/mutorch/blob/main/demo.ipynb">Demo Notebook</a>. <em>Loss functions</em> and <em>optimizer implementations</em> are also provided to build an end-to-end understanding of neural network training process. The framework also provides a simple way to visualize the computational graph using <a href="https://graphviz.org/">Graphviz</a>.</p>
<div class="image">
<img src="decision_boundaries.png" alt=""/>
</div>
   <h1><a class="anchor" id="autotoc_md1"></a>
Building a Neural Network</h1>
<p>The framework can be used in a few ways:</p>
<h2><a class="anchor" id="autotoc_md2"></a>
1. Node-level: The framework can be used to build a single node and then use it to build a computational graph.</h2>
<div class="fragment"><div class="line">from mutorch import Node</div>
<div class="line">from mutorch import nn</div>
<div class="line"> </div>
<div class="line"># define a node and perform some operations</div>
<div class="line">x = Node(1, name=&#39;x&#39;, requires_grad=True)</div>
<div class="line">x = x + 2</div>
<div class="line">x = x * 3</div>
<div class="line">x = x ** 0.5</div>
<div class="line">x = x / 4</div>
<div class="line">x = nn.Tanh()(x)</div>
<div class="line">y = (x + 1.1) * 1.2</div>
<div class="line">x = nn.ReLU()(y)</div>
<div class="line">x = (x - 2.3) / 1.4</div>
<div class="line">x = nn.Sigmoid()(x)</div>
<div class="line"># perform a backward pass</div>
<div class="line">x.backward()</div>
</div><!-- fragment --><div class="image">
<img src="node_graph.png" alt=""/>
</div>
   <h2><a class="anchor" id="autotoc_md3"></a>
2. Tensor-level: An example of tensor-level operation is shown below:</h2>
<div class="fragment"><div class="line">import mutorch</div>
<div class="line">from mutorch import nn</div>
<div class="line"> </div>
<div class="line"># define tensors and perform some operations</div>
<div class="line">x = mutorch.Tensor([[1,2,3,4,5],</div>
<div class="line">                    [2,3,4,5,6]])</div>
<div class="line">w = mutorch.Tensor([[1.0, 1.1, 1.2, 1.3, 1.4], </div>
<div class="line">                    [2.0, 2.1, 2.2, 2.3, 2.4]])</div>
<div class="line">bias = mutorch.Tensor([[1.0, 2.0, 3.0, 4.0, 5.0],</div>
<div class="line">                    [2.0, 3.0, 4.0, 5.0, 6.0]])  </div>
<div class="line">z = ( x * w ) + bias</div>
<div class="line">z = z / 2.2</div>
<div class="line">z = nn.Tanh()(z)</div>
<div class="line"># perform backward pass</div>
<div class="line">z.backward()</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md4"></a>
3. Sequential MLP: The framework can be used to build a complete neural network through sequential layers. An example is shown below:</h2>
<div class="fragment"><div class="line">from mutorch import nn</div>
<div class="line"> </div>
<div class="line"># define a sequential neural network with non-linear activation</div>
<div class="line">model = nn.Sequential(</div>
<div class="line">            nn.Linear( input_size=5, output_size=10, activation=nn.Tanh() ),</div>
<div class="line">            nn.Linear( input_size=10, output_size=10, activation=nn.ReLU() ),</div>
<div class="line">            nn.Linear( input_size=10, output_size=1, activation=nn.Sigmoid() )</div>
<div class="line">        )</div>
<div class="line"># define an example input tensor with batch size 2</div>
<div class="line">x = [[1,2,3,4,5], [2,3,4,5,6]]</div>
<div class="line"># perform a forward pass</div>
<div class="line">y = model( x )</div>
<div class="line"># perform a backward pass</div>
<div class="line">y.backward()</div>
</div><!-- fragment --><div class="image">
<img src="sequential_graph.png" alt=""/>
</div>
   <p><br  />
</p>
<h1><a class="anchor" id="autotoc_md5"></a>
Optimizers</h1>
<p>The framework provides a simple way to build optimizers and use them during the neural network training process. Few examples of optimizers provided within the framework include SGD, Adam, etc.</p>
<div class="fragment"><div class="line"># example of defining an Adam optimizer</div>
<div class="line">from mutorch import optim</div>
<div class="line">optimizer = optim.Adam(model.parameters(), lr=0.01)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md6"></a>
Loss Functions</h1>
<p>Loss functions can be easily built using the MuTorch framework. Few example losses implemented within the framework include MSE, L1, SmoothL1, etc.</p>
<div class="fragment"><div class="line"># example of defining an MSE loss</div>
<div class="line">from mutorch import losses</div>
<div class="line">loss_fn = losses.MSELoss()</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md7"></a>
Training a Neural Network</h1>
<p>Putting it all together, the framework can be used to build a complete neural network and train it using a loss function and an optimizer. An example is shown below:</p>
<div class="fragment"><div class="line">import mutorch</div>
<div class="line">from mutorch import nn, losses, optim</div>
<div class="line"> </div>
<div class="line"># input tensor</div>
<div class="line">x = mutorch.Tensor([[0.6, -0.35,  0.47,  0.71,  0.12],</div>
<div class="line">                    [0.3,  0.45, -0.67, -0.89,  0.23],</div>
<div class="line">                    [0.5,  0.65,  0.87,  0.99,  0.34],</div>
<div class="line">                    [0.7, -0.85,  0.97, -0.11,  0.45],</div>
<div class="line">                    [0.9, -0.01, -0.13,  0.25, -0.56],</div>
<div class="line">                    [-0.2, 0.32, -0.54,  0.76,  0.98]])</div>
<div class="line"># ground truth</div>
<div class="line">y = mutorch.Tensor([[0.0], </div>
<div class="line">                    [0.0], </div>
<div class="line">                    [0.0], </div>
<div class="line">                    [1.0], </div>
<div class="line">                    [1.0], </div>
<div class="line">                    [1.0]])</div>
<div class="line"># define a sequential neural network with non-linear activation</div>
<div class="line">model = nn.Sequential(</div>
<div class="line">            nn.Linear( input_size=5, output_size=10, activation=nn.Tanh() ),</div>
<div class="line">            nn.Linear( input_size=10, output_size=10, activation=nn.ReLU() ),</div>
<div class="line">            nn.Linear( input_size=10, output_size=1, activation=nn.Sigmoid() )</div>
<div class="line">    )</div>
<div class="line"># define an optimizer and loss function</div>
<div class="line">optimizer = optim.Adam(model.parameters(), lr=0.01)</div>
<div class="line">loss_fn = losses.MSELoss()</div>
<div class="line"># perform 500 epochs of training</div>
<div class="line">for epoch in range(500):</div>
<div class="line">    # reset the gradients</div>
<div class="line">    optimizer.zero_grad()</div>
<div class="line">    # perform a forward pass</div>
<div class="line">    y_pred = model(x)</div>
<div class="line">    # compute the loss</div>
<div class="line">    loss = loss_fn(y_pred, y)</div>
<div class="line">    # perform a backward pass</div>
<div class="line">    loss.backward()</div>
<div class="line">    # update the parameters</div>
<div class="line">    optimizer.step()</div>
</div><!-- fragment --><div class="fragment"><div class="line">Ground truth:  [0.0, 0.0, 0.0, 1.0, 1.0, 1.0]</div>
<div class="line">Model output before training:  [0.2625455157756882, 0.06476329944788511, 0.09198898000403521, 0.13625100888110614, 0.3455240473051357, 0.04765093283946377]</div>
<div class="line">#################### Starting model training...</div>
<div class="line">Epoch 500/500 - Loss: 0.000075: 100% ||||||||||||||||||||||||| [00:07&lt;00:00, 69.41it/s]</div>
<div class="line">#################### Training complete!</div>
<div class="line">Model output after training:  [0.012926827557352217, 0.008991985611204682, 0.0027829626242188233, 0.9912839449884999, 0.9925483053096971, 0.9921878687511471]</div>
</div><!-- fragment --><p>Model weights can further be saved and loaded using <code>model.save(filename)</code> and <code>model.load(filename)</code> respectively.</p>
<p>This was just a toy example, but it can easily be extended to a more realistic problem such as classification. One can also further dissect the model to visualize the decision boundary as shown in the figure above.&#160;</p>
<p><b>For a better understanding of the framework, examples on how to train models for realistic problems, please see the <a href="https://github.com/towardsautonomy/mutorch/blob/main/demo.ipynb">Demo Notebook</a>.</b> </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
